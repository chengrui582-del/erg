<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>City Social</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  margin:0;color:#fff;
  background:
    linear-gradient(rgba(0,0,0,.6),rgba(0,0,0,.85)),
    url("https://images.unsplash.com/photo-1499346030926-9a72daac6c63") center/cover fixed;
  font-family:-apple-system,BlinkMacSystemFont;
}
header{
  display:flex;justify-content:space-between;
  padding:14px 20px;
  background:#000c;
}
button{
  background:#1f6feb;color:#fff;
  border:none;border-radius:20px;
  padding:8px 14px;cursor:pointer;
}
input,textarea{
  width:100%;background:#000;
  border:1px solid #333;color:#fff;
  padding:10px;border-radius:10px;
}
main{display:grid;grid-template-columns:2fr 1fr;gap:20px;padding:20px}
.card{
  background:#111c;border-radius:16px;
  padding:16px;margin-bottom:16px;
}
.hidden{display:none}
.post img{width:100%;border-radius:12px;margin-top:8px}
</style>
</head>

<body>
<header>
  <h3>ðŸŒƒ City Social</h3>
  <button id="logout" class="hidden">ç™»å‡º</button>
</header>

<main>
<section>
  <div class="card" id="auth">
    <h3>ç™»å…¥ / è¨»å†Š</h3>
    <input id="user" placeholder="å¸³è™Ÿ">
    <input id="pass" type="password" placeholder="å¯†ç¢¼">
    <button onclick="login()">é–‹å§‹</button>
  </div>

  <div class="card hidden" id="postBox">
    <textarea id="text" placeholder="åˆ†äº«åŸŽå¸‚æ•…äº‹..."></textarea>
    <input type="file" id="img">
    <button onclick="publish()">ç™¼å¸ƒ</button>
  </div>

  <div id="feed"></div>
</section>

<aside>
  <div class="card hidden" id="profile">ðŸ‘¤ <span id="me"></span></div>
</aside>
</main>

<script>
let current=null
const users=JSON.parse(localStorage.users||"{}")
const posts=JSON.parse(localStorage.posts||"[]")

function save(){
  localStorage.users=JSON.stringify(users)
  localStorage.posts=JSON.stringify(posts)
}

function login(){
  const u=user.value,p=pass.value
  if(!u||!p)return alert("è«‹è¼¸å…¥")
  if(!users[u])users[u]={pass:p}
  if(users[u].pass!==p)return alert("å¯†ç¢¼éŒ¯")
  current=u
  auth.classList.add("hidden")
  postBox.classList.remove("hidden")
  profile.classList.remove("hidden")
  logout.classList.remove("hidden")
  me.textContent=u
  render()
}

logout.onclick=()=>location.reload()

function publish(){
  if(!current)return alert("è«‹å…ˆç™»å…¥")
  if(!text.value)return alert("è«‹è¼¸å…¥å…§å®¹")

  const file=img.files[0]
  if(file){
    const r=new FileReader()
    r.onload=e=>{
      posts.unshift({u:current,t:text.value,img:e.target.result})
      save();render()
    }
    r.readAsDataURL(file)
  }else{
    posts.unshift({u:current,t:text.value})
    save();render()
  }
  text.value="";img.value=""
}

function render(){
  feed.innerHTML=""
  posts.forEach(p=>{
    feed.innerHTML+=`
      <div class="card post">
        <b>${p.u}</b>
        <div>${p.t}</div>
        ${p.img?`<img src="${p.img}">`:""}
      </div>`
  })
}
</script>
</body>
</html>

