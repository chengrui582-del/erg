<!DOCTYPE html>
<html>
<head>
  <title>簡單社交網站</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js"></script>
</head>
<body>
  <h1>社交網站 Demo</h1>

  <div id="auth">
    <input type="email" id="email" placeholder="Email">
    <input type="password" id="password" placeholder="Password">
    <button onclick="signup()">註冊</button>
    <button onclick="login()">登入</button>
  </div>

  <div id="postSection" style="display:none;">
    <input type="text" id="postContent" placeholder="輸入貼文">
    <button onclick="addPost()">發貼文</button>
    <h2>動態牆</h2>
    <div id="feed"></div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT.firebaseapp.com",
      databaseURL: "https://YOUR_PROJECT.firebaseio.com",
      projectId: "YOUR_PROJECT",
    };
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();

    function signup(){
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      auth.createUserWithEmailAndPassword(email, password)
          .then(() => alert('註冊成功'))
          .catch(err => alert(err.message));
    }

    function login(){
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      auth.signInWithEmailAndPassword(email, password)
          .then(() => {
            document.getElementById('auth').style.display='none';
            document.getElementById('postSection').style.display='block';
            loadPosts();
          })
          .catch(err => alert(err.message));
    }

    function addPost(){
      const content = document.getElementById('postContent').value;
      const user = auth.currentUser.email;
      db.ref('posts').push({user, content, timestamp:Date.now()});
      document.getElementById('postContent').value='';
    }

    function loadPosts(){
      db.ref('posts').on('value', snapshot => {
        const feed = document.getElementById('feed');
        feed.innerHTML='';
        snapshot.forEach(child => {
          const p = document.createElement('p');
          p.textContent = child.val().user + ": " + child.val().content;
          feed.appendChild(p);
        });
      });
    }
  </script>
</body>
</html>
