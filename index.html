<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>City Social</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1877f2">

<style>
:root{
  --bg:#0f1115;--card:#181b22;--text:#fff;--sub:#aaa;--blue:#1877f2;
}
.light{
  --bg:#f4f4f4;--card:#fff;--text:#000;--sub:#555;
}
*{box-sizing:border-box;font-family:system-ui}
body{
  margin:0;background:linear-gradient(rgba(0,0,0,.6),rgba(0,0,0,.9)),
  url("https://images.unsplash.com/photo-1499346030926-9a72daac6c63?auto=format&fit=crop&w=1200");
  background-size:cover;background-attachment:fixed;color:var(--text);
}
.hidden{display:none}
button{background:var(--blue);color:#fff;border:none;border-radius:20px;padding:6px 14px}

header{
  position:sticky;top:0;z-index:10;
  background:var(--card);
  display:flex;justify-content:space-between;
  padding:10px 14px;font-weight:700
}
header span{cursor:pointer}

#app{max-width:420px;margin:auto}

.card{background:var(--card);margin:12px;border-radius:14px;padding:12px}

.post img{width:100%;border-radius:10px}
.post-images{
  display:flex;overflow-x:auto;scroll-snap-type:x mandatory
}
.post-images img{flex-shrink:0;scroll-snap-align:center}
.post-head{display:flex;align-items:center;gap:8px}
.avatar{width:36px;height:36px;border-radius:50%;object-fit:cover}
.actions{font-size:22px;padding:6px 0}

.nav{
  position:fixed;bottom:0;left:0;right:0;
  background:var(--card);
  display:flex;justify-content:space-around;
  padding:6px 0
}
.nav span{font-size:22px;cursor:pointer}

input,textarea{
  width:100%;border-radius:10px;border:none;
  padding:8px;margin:6px 0
}
</style>
</head>

<body>
<div id="app">

<header>
  <span>City Social</span>
  <div>
    <span onclick="toggleMode()">ğŸŒ™</span>
    <span onclick="logout()">ğŸšª</span>
  </div>
</header>

<!-- ç™»å…¥ -->
<div id="login" class="card">
  <h3>ç™»å…¥</h3>
  <input id="name" placeholder="è¼¸å…¥æš±ç¨±">
  <button onclick="login()">ç™»å…¥</button>
</div>

<!-- å‹•æ…‹ç‰† -->
<div id="feed" class="hidden">
  <div class="card">
    <textarea id="postText" placeholder="ç™¼æ–‡å…§å®¹"></textarea>
    <input type="file" id="postImg" multiple>
    <button onclick="addPost()">ç™¼å¸ƒ</button>
  </div>
  <div id="posts"></div>
</div>

<!-- èŠå¤© -->
<div id="chat" class="hidden">
  <div id="chatBox" class="card" style="height:300px;overflow:auto"></div>
  <input id="msg" placeholder="è¼¸å…¥è¨Šæ¯">
  <input type="file" id="chatImg">
  <button onclick="sendMsg()">é€å‡º</button>
</div>

<!-- å€‹äººé  -->
<div id="profile" class="hidden">
  <div class="card">
    <img id="cover" src="https://picsum.photos/400/150">
    <img id="avatar" class="avatar" src="https://i.pravatar.cc/100">
    <h3 id="me"></h3>
    <p id="friends"></p>
  </div>
  <div id="myPosts"></div>
</div>

</div>

<div class="nav">
  <span onclick="view('feed')">ğŸ </span>
  <span onclick="view('chat')">ğŸ’¬</span>
  <span onclick="view('profile')">ğŸ‘¤</span>
</div>

<script>
let user=null,posts=[],msgs=[];
if(localStorage.user){user=localStorage.user;init()}

function login(){
  user=name.value;
  localStorage.user=user;
  init();
}
function logout(){
  localStorage.clear();location.reload();
}
function init(){
  loginDiv.style.display="none";
  view('feed');
  me.innerText=user;
}
function view(v){
  feed.classList.add("hidden");
  chat.classList.add("hidden");
  profile.classList.add("hidden");
  document.getElementById(v).classList.remove("hidden");
}
function toggleMode(){
  document.body.classList.toggle("light");
}
function addPost(){
  const txt=postText.value;
  const imgs=[...postImg.files].map(f=>URL.createObjectURL(f));
  posts.unshift({u:user,t:txt,i:imgs});
  renderPosts();
}
function renderPosts(){
  postsDiv.innerHTML="";
  posts.forEach(p=>{
    postsDiv.innerHTML+=`
    <div class="card post">
      <div class="post-head">
        <img class="avatar" src="https://i.pravatar.cc/40">
        <b>${p.u}</b>
      </div>
      <div class="post-images">
        ${p.i.map(i=>`<img src="${i}">`).join("")}
      </div>
      <div class="actions">â¤ï¸ ğŸ’¬</div>
      <div>${p.t}</div>
    </div>`;
  });
}
function sendMsg(){
  if(msg.value){
    msgs.push(`<b>${user}ï¼š</b>${msg.value}`);
    chatBox.innerHTML=msgs.join("<br>");
    msg.value="";
  }
}

if("serviceWorker"in navigator){
  navigator.serviceWorker.register("sw.js");
}
</script>
</body>
</html>

